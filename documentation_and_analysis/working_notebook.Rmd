---
title: "Final Project workbook"
output: html_notebook
---

```{r include=FALSE}
# load libraries
library(tidyverse)
library(janitor)
library(jsonlite)
library(here)
library(lubridate)
library(leaflet)
library(tsibbledata)
library(tsibble)
library(elevatr)
library(rgdal)


```

```{r}
# Load in data
hires_2019_clean <- read_csv('../clean_data/hires_2019_clean.csv')

```



```{r}
# number of stations in total: 164
hires_2019_clean %>% 
  distinct(start_station_id) %>% 
  count()

hires_2019_clean %>% 
  distinct(end_station_id) %>% 
  count()
```


```{r}
# visualising use by month
hires_2019_clean %>% 
  mutate(month = month(start_date, label = TRUE), .before = 1) %>% 
  group_by(month) %>% 
  summarise(count = n()) %>%
  ggplot() +
  aes(x = month, y = count) +
  geom_col(fill = "blue") +
  geom_text(aes(label = count), vjust = 2, colour = "white", size = 3) +
  labs(x = "Month",
       y = "Number of journeys",
       title = "Total number of bike journeys by month (2019)") +
  theme_minimal() +
  theme(title = element_text(size = 14),
        axis.text = element_text(size = 10),
        axis.title.x = element_text(size = 10),
        axis.title.y = element_text(size = 10))
```


```{r}
hires_2019_clean %>% 
  leaflet() %>% 
  addProviderTiles(providers$CartoDB.Positron) %>% 
  addTiles(providers$CartoDB.Positron) %>%
  addCircles(lng = ~start_station_longitude,
             lat = ~start_station_latitude,
             popup = ~paste0("Station ID: ", start_station_name),
             radius = ~number_of_trips/25)
```
